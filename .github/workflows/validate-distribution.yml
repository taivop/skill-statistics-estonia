name: Validate Distribution

on:
  push:
  pull_request:

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Validate Codex skills
        run: python3 scripts/validate_codex_skills.py

      - name: Generate plugin manifests
        run: python3 scripts/generate_plugin_manifests.py

      - name: Generate marketplace
        run: python3 scripts/generate_marketplace.py

      - name: Validate Anthropic plugin files
        run: python3 scripts/validate_anthropic_plugins.py

      - name: Ensure generated files committed
        run: git diff --exit-code
